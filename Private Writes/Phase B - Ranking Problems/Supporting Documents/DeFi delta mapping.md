
## 1) Transfers-only vs DeFi-grade lifecycle privacy

Key differences:
- The unit of privacy shifts from a single transfer to an end-to-end position lifecycle (multi-write workflows), including real-world touchpoints such as relayers, paymasters, aggregators, and submission metadata (routing + timing). 
- Private-to-private composability and boundary privacy become gating for DeFi workflows: if privacy breaks at app boundaries or at bridge/shield boundaries, lifecycles are forced into public detours that reintroduce linkability at high-signal points. 
- Anonymity-set fragmentation becomes structurally worse under DeFi because activity shards by asset, venue, product type, and chain; this also couples privacy to liquidity fragmentation and market-quality constraints (e.g., slippage and liquidation quality). 
- DeFi primitives introduce shared-state leakage surfaces that are muted or absent in transfers-only framing (e.g., AMM reserve/invariant surfaces, lending utilization/aggregate debt jumps, and inherently revealing liquidation events).
- “Minimum public/provable global state” becomes a first-class privacy constraint: even with private users/amounts, DeFi often needs public/provable signals (e.g., reserves/utilization/oracle references), creating residual leakage and per-write DA/proof overhead.
- Cost and throughput constraints tighten because DeFi writes are structurally heavier and more frequent than transfers; high-frequency position updates and stress bursts amplify proof + DA overhead and expose latency/throughput ceilings.
- Stress-mode liveness becomes a safety requirement (not just a scaling metric): volatility and liquidation waves create bursty, adversarial load, and inability to close debt or exit quickly becomes direct, time-bounded financial loss. 
- Selective disclosure and compliance interfaces become lifecycle constraints: controlled visibility and repeatable eligibility checks are needed, but repeated credential proofs and view-key sprawl can silently create stable pseudonyms across multi-step workflows. 
- Operability, auditability, and upgrade surfaces become DeFi safety constraints: financial logic in private circuits/engines needs observability and upgrade control without creating privacy-breaking “observability backdoors.” 
- Network-layer metadata leakage (RPC/sequencer/relayer routing + timing) becomes more acute because DeFi strategies are repeated and time-sensitive (especially near liquidation), enabling correlation even when onchain payloads are private. 
- Incentive fragility in privacy infrastructure (provers/relayers/keepers) becomes protocol risk under volatility: incentives can degrade “when needed most,” and privileged roles (e.g., keepers) can concentrate governance power and create new failure modes. 

## 2) Lifecycle surfaces

### Boundary entry and exit (bridge/shield/unshield; deposits/withdrawals)

Privacy requirement: keep boundary events from becoming linkable “public edges” that connect private activity to public identities or to specific lifecycles.
Typical leakage risk (Phase A framing): amount + timing matching at boundaries (especially under low volume or urgency), distinctive wrapper/representation fingerprints, and repeated “round trips” that compound linkage signals.

### Multi-write position lifecycle (deposit → borrow/swap/adjust → repay/close)

Privacy requirement: prevent observers from reconstructing an end-to-end lifecycle as “one user did a lifecycle” across many writes.
Typical leakage risk: repeated timing-correlated interactions across contracts and shared infrastructure choices create distinctive graph motifs; even if each write is private in isolation, the lifecycle can often be stitched together.

### Fee payment, relayers/paymasters, and routing through shared intermediaries

Privacy requirement: enable transaction inclusion and fee payment without turning relayer choice, paymaster funding, or repeated top-ups into stable fingerprints.
Typical leakage risk: relayer/paymaster patterns become identifiable hubs; urgency-driven reuse of the same intermediaries tightens correlation across lifecycle writes.

### Network-layer submission metadata (RPC/sequencer/relayer timing + endpoint choice)

Privacy requirement: treat offchain submission metadata as part of the threat model for DeFi-grade privacy.
Typical leakage risk: endpoint choice, timing, routing, and client/network fingerprints correlate otherwise-unlinkable actions; time-critical behavior (e.g., near liquidation) strengthens timing correlation.

### Cross-app / multi-protocol actions (private-to-private composability)

Privacy requirement: keep multi-step, cross-app actions private without forcing declassification or public detours.
Typical leakage risk: incompatible private domains and lack of private contract-call composability push users into boundary hops (unshielding, trusted intermediaries), reintroducing linkability at high-signal points.

### Shared-state DeFi primitives and “minimum public/provable global state” (pricing/risk surfaces)

Privacy requirement: support the minimum global signals DeFi needs for safety/composability while bounding residual leakage.
Typical leakage risk: public/provable aggregate signals (e.g., AMM reserve/invariant surfaces, lending utilization/aggregate debt jumps, oracle references) leak market-moving activity; liquidation events are inherently revealing.

### Stress events (throughput + liveness during volatility/liquidation waves)

Privacy requirement: maintain liveness for time-sensitive safety actions under bursty, adversarial load.
Typical leakage risk: throughput collapse or censorship can force distinctive user behaviors (urgent retries, repeated routing), while delayed inclusion can directly cause financial loss; stress windows also amplify timing correlation.


### Selective disclosure and eligibility across a lifecycle (compliance interface)

Privacy requirement: enable controlled visibility (positions, solvency, dispute resolution) and eligibility checks without making long-lived positions or repeated actions linkable.
Typical leakage risk: view-key sprawl, repeated credential proofs, and identity bindings act as stable cor
### Operability, monitoring/debugging, upgrades, and infrastructure incentives

Privacy requirement: operate, audit, and upgrade private systems without creating privacy-bypassing telemetry, and without relying on brittle incentive/role structures.
Typical leakage risk: “observability backdoors” and privileged roles (operators/keepers/relayers) can become centralized chokepoints; incentives may degrade under stress, worsening liveness and governance risk.

## 3) PID mapping table

Mapping from DeFi lifecycle surfaces (Phase A framing) to existing Phase B PIDs. PID titles and cluster labels are the locked Phase B strings (see lockfile). If a surface spans multiple PIDs, it is listed as a multi-mapping (not a new category).

| DeFi lifecycle surface                                                               | Phase A “issue” (short)                                                                                                                                                                         | Mapped PID IDs + exact titles                                                                                                                                                       | Why this PID covers it                                                                                                                                                                                                                                                                                                                                                                                                |
| ------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Boundary entry/exit (bridge/shield/unshield; deposits/withdrawals)                   | Boundary events create linkable public edges (amount/timing matching; wrapper fingerprints; repeated round trips), especially under low volume or urgency.                                      | P13 — Cross-Domain Privacy Leakage in Bridging<br>P01 — Transaction Graph Leakage<br>P02 — Fragmented Anonymity Sets                                                                | Primary coverage sits in the `Composability & interoperability` and `Privacy leakage & anonymity` clusters: P13 defines boundary-edge linkage (public↔private / chain↔chain), while P01 captures how boundary hops become reusable graph motifs across a lifecycle. P02 is often implicated because boundary privacy degrades further when volumes are fragmented across assets/venues.                               |
| Multi-write position lifecycle (deposit → borrow/swap/adjust → repay/close)          | Multi-step workflows leave timing-correlated footprints that can be stitched into a “one user did a lifecycle” graph, even if each write is private in isolation.                               | P01 — Transaction Graph Leakage<br>P09 — Private Fee Payment and Relayer Friction<br>P19 — Network-Layer Metadata Leakage                                                           | This maps to the `Privacy leakage & anonymity` cluster via P01 (interaction-graph motifs across many writes) and to the `UX & developer experience` cluster via P09 (relayer/paymaster touchpoints that become stable fingerprints). P19 is complementary: it captures offchain submission metadata correlation that can connect lifecycle steps even when onchain graphs are locally shielded.                       |
| Fee payment + relayers/paymasters (inclusion path)                                   | Private fee payment and relayer/paymaster use can reintroduce linkability (stable intermediaries, repeated top-ups) and can become fragile under urgency.                                       | P09 — Private Fee Payment and Relayer Friction<br>P01 — Transaction Graph Leakage<br>P19 — Network-Layer Metadata Leakage                                                           | P09 is the direct locus (fee payment + relayer friction) in the `UX & developer experience` cluster; Phase A also frames these intermediaries as creating graph hubs (P01) and/or routing/timing fingerprints (P19). Under DeFi lifecycles, repeated use of the same inclusion path compounds correlation risk.                                                                                                       |
| Network-layer submission metadata (RPC/sequencer/relayer routing + timing)           | Endpoint choice, timing, and routing metadata can correlate DeFi actions across time; time-critical behavior (e.g., near liquidation) strengthens timing correlation.                           | P19 — Network-Layer Metadata Leakage                                                                                                                                                | P19 is the canonical coverage in `Privacy leakage & anonymity`: it explicitly frames offchain submission metadata as a correlation channel distinct from onchain interaction graphs. In the DeFi framing, repeated and time-sensitive actions increase the entropy available to a network observer.                                                                                                                   |
| Anonymity + liquidity fragmentation by market (asset/pair/venue/product)             | DeFi shards users by market structure (asset pair, venue, product type, chain), shrinking effective anonymity sets and coupling privacy to market quality (slippage/liquidation quality).       | P02 — Fragmented Anonymity Sets                                                                                                                                                     | P02 provides direct coverage, spanning `Privacy leakage & anonymity` and `Composability & interoperability`: it frames anonymity sets as fragmented across pools/assets/domains. In the DeFi column, Phase A emphasizes that market stratification is structural (not incidental), so fragmentation is a persistent gating condition for usable private DeFi.                                                         |
| Cross-app / multi-protocol actions (atomic DeFi workflows)                           | Without private-to-private composability, atomic multi-protocol actions break across app boundaries unless data is declassified or workflows detour through public hops/trusted intermediaries. | P12 — Lack of Private-to-Private Composability<br>P13 — Cross-Domain Privacy Leakage in Bridging                                                                                    | P12 is the direct coverage in `Composability & interoperability`: it defines the inability to make private contract calls across apps/protocols without declassification. P13 frequently co-occurs because the “fallback” for missing composability is often boundary hopping between privacy silos, which reintroduces cross-domain linkability.                                                                     |
| Shared-state DeFi primitives (AMMs, lending) and residual leakage                    | Economic shared-state surfaces (e.g., reserves/utilization changes; liquidation events) can reveal private intent even when balances/participants are private.                                  | P11 — Private Execution Leakage in DeFi Primitives<br>P03 — High L1 Costs for Private Verification and Data Availability                                                            | P11 (in `Privacy leakage & anonymity`) frames DeFi-specific execution leakage arising from shared pricing/risk state that often must remain public or publicly provable. P03 (in `Data availability, scalability & exits`) is tightly coupled in Phase A because the “minimum public/provable” signals still require verification and data posting, increasing overhead and sometimes forcing coarser public signals. |
| Cost per complex private write (swap/borrow/liquidation) vs per transfer             | Per-operation proofs are heavier than transfers; high-frequency writes amplify costs; DeFi often must post/prove global fields (e.g., oracle references) that add verification/DA overhead.     | P03 — High L1 Costs for Private Verification and Data Availability<br>P04 — Limited Throughput for Privacy-Preserving Rollups                                                       | P03 is the direct coverage for cost floors and DA/verification overhead in `Data availability, scalability & exits`, and Phase A explicitly notes DeFi operations are structurally heavier and more frequent than transfers. P04 is often implicated because throughput ceilings interact with these per-write costs under bursty, stateful workloads.                                                                |
| Stress-mode throughput and time-to-inclusion (liquidation waves / mass deleveraging) | Bursty, adversarial load makes throughput and latency safety-critical; time-sensitive DeFi actions cannot be queued indefinitely.                                                               | P04 — Limited Throughput for Privacy-Preserving Rollups<br>P05 — Lack of User-Resilient Exits<br>P06 — Trust-Heavy DA Committees and Operators                                      | This is anchored in the `Data availability, scalability & exits` cluster via P04 (throughput bottlenecks) and P05 (exit ability when conditions worsen). P06 bridges into `Governance & operational risk` by framing operator/committee trust and censorship/withholding risk, which becomes acute under stress windows.                                                                                              |
| User-resilient exits and DA/operator trust under failure                             | DA failures, withheld encrypted state, or censorship can trap private state and block exits; in DeFi, delays become direct financial loss (can’t close debt).                                   | P05 — Lack of User-Resilient Exits<br>P06 — Trust-Heavy DA Committees and Operators<br>P13 — Cross-Domain Privacy Leakage in Bridging                                               | P05 and P06 provide direct coverage (respectively: user-resilient exits; trust-heavy DA committees/operators) spanning `Data availability, scalability & exits` and `Governance & operational risk`. P13 can re-enter in DeFi because exit/bridge routines are often boundary events where urgency tightens amount/timing correlations and worsens privacy loss.                                                      |
| Selective disclosure + eligibility across a lifecycle (without stable pseudonyms)    | Controlled visibility and eligibility checks are needed for participation, but repeated proofs/view keys can become stable correlators across long-lived positions and multi-step workflows.    | P14 — Missing Selective-Disclosure Standards<br>P15 — Immature Privacy-Preserving Compliance<br>P16 — Identity Binding Without Linkability<br>P08 — Multi-Key Management Complexity | Coverage sits in `Compliance & selective disclosure` (P14/P15) and overlaps with `Privacy leakage & anonymity` via P16 (identity binding without linkability). P08 is often a practical gating factor (multi-key complexity) because selective disclosure and audit keys multiply key material and operational surfaces across a lifecycle.                                                                           |
| Operability, monitoring/debugging, upgrades (DeFi safety surfaces)                   | Private financial logic needs observability, auditability, and constrained upgrades; ad-hoc telemetry can become privacy bypass (“observability backdoors”).                                    | P17 — Monitoring, Observability, and Debugging Blindness<br>P07 — Upgrade and Governance Risks for Private Circuits<br>P10 — Poor Developer Tooling for Private Logic               | P17 anchors the operability constraint (monitoring/observability/debugging) spanning `Governance & operational risk` and `UX & developer experience`. P07 captures upgrade/governance risks for private circuits, and P10 captures builder tooling limits that make correctness and audit harder under DeFi-grade complexity.                                                                                         |
| Incentive fragility in privacy infrastructure roles (provers/relayers/keepers)       | Incentives can degrade when needed most (volatility/liquidations); privileged keepers/relayers can concentrate power and create stress-mode failure modes.                                      | P18 — Incentive Fragility in Privacy Infrastructure<br>P06 — Trust-Heavy DA Committees and Operators<br>P09 — Private Fee Payment and Relayer Friction                              | P18 is the canonical coverage in `Governance & operational risk`, and Phase A explicitly ties DeFi volatility and liquidation dynamics to incentive brittleness. P06 and P09 often appear adjacent because “always-on” infra roles and relayer inclusion paths can become centralized chokepoints and interact with DA/operator trust assumptions.                                                                    |


## 4) Which constraints become gating under DeFi

Constraints/tradeoffs that intensify under DeFi-grade lifecycle privacy (phrased neutrally; each references affected PIDs and Phase A evidence):

- (P01, P09) Lifecycle privacy is constrained by repeatable touchpoints: relayer/paymaster/aggregator choices and fee funding can become stable correlators across multi-write workflows (graph hubs), especially under urgency. 
- (P19) Offchain submission metadata is a binding constraint: even with private payloads, routing/timing/endpoint metadata can correlate repeated DeFi actions, and time-critical behavior (e.g., near liquidation) intensifies correlation risk. 
- (P13, P01) Boundary unlinkability becomes harder because DeFi has more round trips (entry → action(s) → exit) and more distinctive boundary assets (e.g., LP tokens / wrapped collateral), tightening amount/timing matching and fingerprinting risk. 
- (P02) Anonymity-set and liquidity fragmentation are structural constraints: DeFi naturally shards by asset pair, venue, and product role (LP/borrower/trader), shrinking effective anonymity sets and creating a privacy ↔ market-quality coupling. 
- (P12, P13) Private-to-private composability is a gating condition for DeFi-grade workflows: lack of cross-app private calls forces declassification or public boundary hops that reintroduce linkability exactly at the most revealing points. 
- (P11, P03) Shared-state leakage is unavoidable in many DeFi primitives: safety/composability pressures push some global/pricing/risk state to be public or publicly provable, and those aggregate surfaces can leak market-moving activity (especially around liquidations). 
- (P03, P04) Cost per write and verification/DA overhead become binding under DeFi frequency: per-operation proofs are heavier than transfers and are paid repeatedly; fee volatility and high cost floors can force delaying/batching/routing behaviors that interact with leakage and liveness constraints. 
- (P04, P05, P06) Stress-mode liveness and exits are gating safety constraints: during bursty liquidation waves, throughput collapse, DA withholding, or censorship can prevent timely self-rescue (closing debt/exiting), turning privacy-infra failure into time-bounded loss. 
- (P14, P15, P16, P08) Selective disclosure and eligibility are constrained by unlinkability over time: repeated proofs/credentials and view-key operational patterns can become stable pseudonyms across a lifecycle, undermining privacy even when transaction payloads are shielded. 
- (P17, P07) Operability constraints intensify with DeFi risk: private systems need debugging/monitoring/audit surfaces and safe upgrades, but adding observability backdoors or overly powerful upgrade mechanisms creates governance risk and privacy bypass risk. 
- (P18) Infrastructure incentives are a gating constraint under volatility: provers/relayers/keepers may fail or centralize “when needed most,” and privileged keeper/liquidator roles can create new chokepoints and governance power under stress. 